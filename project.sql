
CREATE TABLE Members (
    ID_Member SERIAL PRIMARY KEY,
    Name VARCHAR(200) NOT NULL,
    Birthday DATE NOT NULL,
    Number VARCHAR(200) NOT NULL
);

CREATE TABLE Sponsors (
    ID_Sponsor SERIAL PRIMARY KEY,
    Email VARCHAR(200) UNIQUE NOT NULL,
    Name VARCHAR(200) NOT NULL
);

CREATE TABLE Parties (
    ID_Party SERIAL PRIMARY KEY,
    Name VARCHAR(200) NOT NULL,
    Date DATE NOT NULL,
    Address VARCHAR(200) NOT NULL
);

CREATE TABLE Sponsorship (
    ID_Unique SERIAL PRIMARY KEY,
    ID_Sponsor INTEGER REFERENCES Sponsors(ID_Sponsor),
    ID_Party INTEGER REFERENCES Parties(ID_Party),
    Category VARCHAR(200) NOT NULL
);

CREATE TABLE Consumptions (
    ID_Consumption SERIAL PRIMARY KEY,
    ID_Party INTEGER REFERENCES Parties(ID_Party),
    Category VARCHAR(200) NOT NULL,
    Price_per_unit DECIMAL(10,2) NOT NULL,
    Number_of_units INTEGER NOT NULL,
    Details VARCHAR(200) NOT NULL
);

CREATE TABLE Enters (
    ID_Unique SERIAL PRIMARY KEY,
    ID_Member INTEGER REFERENCES Members(ID_Member),
    ID_Party INTEGER REFERENCES Parties(ID_Party),
    Status VARCHAR(200) NOT NULL,
    Emergency_number VARCHAR(200),
    University VARCHAR(200)
);

CREATE TABLE Organizers (
    ID_Organizer SERIAL PRIMARY KEY,
    ID_Member INTEGER REFERENCES Members(ID_Member),
    ID_Party INTEGER REFERENCES Parties(ID_Party),
    Name VARCHAR(200) NOT NULL,
    Role VARCHAR(200) NOT NULL
);

CREATE TABLE Members_history (
    ID_Change SERIAL PRIMARY KEY,
    ID_Member INTEGER REFERENCES Members(ID_Member),
    New_number VARCHAR(200),
    History_ditm TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO Members_history (ID_Member, New_number, Previous_number, History_ditm) VALUES
(1, '+79161234567', '2021-01-15 12:30:45'),
(2, '+79262345678', '2021-02-20 14:25:30'),
(3, '+79033456789', '2021-03-10 10:15:20'),
(4, '+79174567890', '2021-04-05 16:40:10'),
(5, '+79285678901', '2021-05-12 11:20:35'),
(6, '+79096789012', '2021-06-18 13:45:50'),
(7, '+79107890123', '2021-07-22 09:30:15'),
(8, '+79218901234','2021-08-30 15:10:40'),
(9, '+79029012345', '2021-09-14 17:25:55'),
(10, '+79130123456','2021-10-25 08:40:25'),
(11, '+79241234567', '2021-11-05 12:15:30'),
(12, '+79052345678', '2021-12-10 14:50:45'),
(13, '+79163456789', '2022-01-15 10:35:20'),
(14, '+79274567890',  '2022-02-20 16:20:35'),
(15, '+79085678901', '2022-03-25 09:45:50');

INSERT INTO Sponsorship (ID_Sponsor, ID_Party, Category) VALUES
(1, 3, 'продукция'),
(2, 4, 'финансовая поддержка'),
(3, 5, 'промокод'),
(4, 1, 'продукция'),
(5, 2, 'финансовая поддержка'),
(6, 3, 'промокод'),
(7, 4, 'продукция'),
(8, 5, 'финансовая поддержка'),
(9, 1, 'промокод'),
(10, 2, 'продукция'),
(11, 3, 'финансовая поддержка'),
(12, 4, 'промокод'),
(13, 5, 'продукция'),
(14, 1, 'финансовая поддержка'),
(15, 2, 'промокод');

INSERT INTO Parties (Name, Date, Address) VALUES
('День рождения ФПМИ', '2021-10-15', 'Клуб "Гараж", Москва, ул. Пушкина, 10'),
('Посвящение первокурсников', '2021-09-05', 'Лофт "Красный Октябрь", Москва, Берсеневская наб., 6'),
('Хеллоуин', '2021-10-31', 'Клуб "Икона", Москва, ул. Тверская, 23'),
('День Святого Валентина', '2022-02-14', 'Лофт "Флакон", Москва, ул. Большая Новодмитровская, 36'),
('Выпускной', '2022-06-25', 'Клуб "Гараж", Москва, ул. Пушкина, 10');

INSERT INTO Organizers (ID_Member, ID_Party, Name, Role) VALUES
-- Party 1 organizers
(1, 1, 'Иванов Александр Сергеевич', 'главный координатор'),
(2, 1, 'Петрова Мария Дмитриевна', 'главный координатор'),
(3, 1, 'Сидоров Дмитрий Игоревич', 'бар'),
(4, 1, 'Кузнецова Анна Владимировна', 'бар'),
(5, 1, 'Смирнов Алексей Петрович', 'вход'),

(6, 2, 'Федорова Екатерина Андреевна', 'главный координатор'),
(7, 2, 'Попов Иван Николаевич', 'главный координатор'),
(8, 2, 'Лебедева Ольга Сергеевна', 'бар'),
(9, 2, 'Козлов Артем Викторович', 'бар'),
(10, 2, 'Новикова Татьяна Михайловна', 'вход'),

(11, 3, 'Морозов Денис Олегович', 'главный координатор'),
(12, 3, 'Волкова Юлия Александровна', 'главный координатор'),
(13, 3, 'Алексеев Павел Денисович', 'бар'),
(14, 3, 'Егорова Надежда Викторовна', 'бар'),
(15, 3, 'Соколов Максим Алексеевич', 'вход'),

(16, 4, 'Белова Анастасия Игоревна', 'главный координатор'),
(17, 4, 'Григорьев Сергей Вадимович', 'главный координатор'),
(18, 4, 'Дмитриева Виктория Сергеевна', 'бар'),
(19, 4, 'Фролов Андрей Константинович', 'бар'),
(20, 4, 'Ковалева Елена Дмитриевна', 'вход'),

(21, 5, 'Орлов Никита Артемович', 'главный координатор'),
(22, 5, 'Антонова Алина Павловна', 'главный координатор'),
(23, 5, 'Тарасов Владислав Ильич', 'бар'),
(24, 5, 'Жукова Дарья Андреевна', 'бар'),
(25, 5, 'Николаев Артур Эдуардовна', 'вход');

-- Insert enters data for first 5 parties (40-50 attendees per party)
-- Party 1 attendees (45)
INSERT INTO Enters (ID_Member, ID_Party, Status, Emergency_number, University) VALUES
(26, 1, 'VIP', '+79161234567', 'МГУ'),
(27, 1, 'Standard', '+79262345678', 'МФТИ'),
(28, 1, 'Standard', '+79033456789', 'НИУ ВШЭ'),
(29, 1, 'VIP', '+79174567890', 'МГИМО'),
(30, 1, 'Standard', '+79285678901', 'МГУ'),
(31, 1, 'Standard', '+79096789012', 'МФТИ'),
(32, 1, 'VIP', '+79107890123', 'НИУ ВШЭ'),
(33, 1, 'Standard', '+79218901234', 'МГИМО'),
(34, 1, 'Standard', '+79029012345', 'МГУ'),
(35, 1, 'VIP', '+79130123456', 'МФТИ'),
(36, 1, 'Standard', '+79241234567', 'НИУ ВШЭ'),
(37, 1, 'Standard', '+79052345678', 'МГИМО'),
(38, 1, 'VIP', '+79163456789', 'МГУ'),
(39, 1, 'Standard', '+79274567890', 'МФТИ'),
(40, 1, 'Standard', '+79085678901', 'НИУ ВШЭ'),
(41, 1, 'VIP', '+79196789012', 'МГИМО'),
(42, 1, 'Standard', '+79207890123', 'МГУ'),
(43, 1, 'Standard', '+79018901234', 'МФТИ'),
(44, 1, 'VIP', '+79129012345', 'НИУ ВШЭ'),
(45, 1, 'Standard', '+79230123456', 'МГИМО'),
(46, 1, 'Standard', '+79041234567', 'МГУ'),
(47, 1, 'VIP', '+79152345678', 'МФТИ'),
(48, 1, 'Standard', '+79263456789', 'НИУ ВШЭ'),
(49, 1, 'Standard', '+79074567890', 'МГИМО'),
(50, 1, 'VIP', '+79185678901', 'МГУ'),
(51, 1, 'Standard', '+79296789012', 'МФТИ'),
(52, 1, 'Standard', '+79007890123', 'НИУ ВШЭ'),
(53, 1, 'VIP', '+79118901234', 'МГИМО'),
(54, 1, 'Standard', '+79229012345', 'МГУ'),
(55, 1, 'Standard', '+79030123456', 'МФТИ'),
(56, 1, 'VIP', '+79141234567', 'НИУ ВШЭ'),
(57, 1, 'Standard', '+79252345678', 'МГИМО'),
(58, 1, 'Standard', '+79063456789', 'МГУ'),
(59, 1, 'VIP', '+79174567890', 'МФТИ'),
(60, 1, 'Standard', '+79285678901', 'НИУ ВШЭ'),
(61, 1, 'Standard', '+79096789012', 'МГИМО'),
(62, 1, 'VIP', '+79107890123', 'МГУ'),
(63, 1, 'Standard', '+79218901234', 'МФТИ'),
(64, 1, 'Standard', '+79029012345', 'НИУ ВШЭ'),
(65, 1, 'VIP', '+79130123456', 'МГИМО'),
(66, 1, 'Standard', '+79241234567', 'МГУ'),
(67, 1, 'Standard', '+79052345678', 'МФТИ'),
(68, 1, 'VIP', '+79163456789', 'НИУ ВШЭ'),
(69, 1, 'Standard', '+79274567890', 'МГИМО'),
(70, 1, 'Standard', '+79085678901', 'МГУ');

INSERT INTO Enters (ID_Member, ID_Party, Status, Emergency_number, University) VALUES
(71, 2, 'VIP', '+79196789012', 'МФТИ'),
(72, 2, 'Standard', '+79207890123', 'НИУ ВШЭ'),
(73, 2, 'Standard', '+79018901234', 'МГИМО'),
(74, 2, 'VIP', '+79129012345', 'МГУ'),
(75, 2, 'Standard', '+79230123456', 'МФТИ'),
(76, 2, 'Standard', '+79041234567', 'НИУ ВШЭ'),
(77, 2, 'VIP', '+79152345678', 'МГИМО'),
(78, 2, 'Standard', '+79263456789', 'МГУ'),
(79, 2, 'Standard', '+79074567890', 'МФТИ'),
(80, 2, 'VIP', '+79185678901', 'НИУ ВШЭ'),
(81, 2, 'Standard', '+79296789012', 'МГИМО'),
(82, 2, 'Standard', '+79007890123', 'МГУ'),
(83, 2, 'VIP', '+79118901234', 'МФТИ'),
(84, 2, 'Standard', '+79229012345', 'НИУ ВШЭ'),
(85, 2, 'Standard', '+79030123456', 'МГИМО'),
(86, 2, 'VIP', '+79141234567', 'МГУ'),
(87, 2, 'Standard', '+79252345678', 'МФТИ'),
(88, 2, 'Standard', '+79063456789', 'НИУ ВШЭ'),
(89, 2, 'VIP', '+79174567890', 'МГИМО'),
(90, 2, 'Standard', '+79285678901', 'МГУ'),
(91, 2, 'Standard', '+79096789012', 'МФТИ'),
(92, 2, 'VIP', '+79107890123', 'НИУ ВШЭ'),
(93, 2, 'Standard', '+79218901234', 'МГИМО'),
(94, 2, 'Standard', '+79029012345', 'МГУ'),
(95, 2, 'VIP', '+79130123456', 'МФТИ'),
(96, 2, 'Standard', '+79241234567', 'НИУ ВШЭ'),
(97, 2, 'Standard', '+79052345678', 'МГИМО'),
(98, 2, 'VIP', '+79163456789', 'МГУ'),
(99, 2, 'Standard', '+79274567890', 'МФТИ'),
(100, 2, 'Standard', '+79085678901', 'НИУ ВШЭ'),
(1, 2, 'VIP', '+79196789012', 'МГИМО'),
(2, 2, 'Standard', '+79207890123', 'МГУ'),
(3, 2, 'Standard', '+79018901234', 'МФТИ'),
(4, 2, 'VIP', '+79129012345', 'НИУ ВШЭ'),
(5, 2, 'Standard', '+79230123456', 'МГИМО'),
(6, 2, 'Standard', '+79041234567', 'МГУ'),
(7, 2, 'VIP', '+79152345678', 'МФТИ'),
(8, 2, 'Standard', '+79263456789', 'НИУ ВШЭ'),
(9, 2, 'Standard', '+79074567890', 'МГИМО'),
(10, 2, 'VIP', '+79185678901', 'МГУ');

INSERT INTO Enters (ID_Member, ID_Party, Status, Emergency_number, University) VALUES
(11, 3, 'VIP', '+79296789012', 'МФТИ'),
(12, 3, 'Standard', '+79007890123', 'НИУ ВШЭ'),
(13, 3, 'Standard', '+79118901234', 'МГИМО'),
(14, 3, 'VIP', '+79229012345', 'МГУ'),
(15, 3, 'Standard', '+79030123456', 'МФТИ'),
(16, 3, 'Standard', '+79141234567', 'НИУ ВШЭ'),
(17, 3, 'VIP', '+79252345678', 'МГИМО'),
(18, 3, 'Standard', '+79063456789', 'МГУ'),
(19, 3, 'Standard', '+79174567890', 'МФТИ'),
(20, 3, 'VIP', '+79285678901', 'НИУ ВШЭ'),
(21, 3, 'Standard', '+79096789012', 'МГИМО'),
(22, 3, 'Standard', '+79107890123', 'МГУ'),
(23, 3, 'VIP', '+79218901234', 'МФТИ'),
(24, 3, 'Standard', '+79029012345', 'НИУ ВШЭ'),
(25, 3, 'Standard', '+79130123456', 'МГИМО'),
(26, 3, 'VIP', '+79241234567', 'МГУ'),
(27, 3, 'Standard', '+79052345678', 'МФТИ'),
(28, 3, 'Standard', '+79163456789', 'НИУ ВШЭ'),
(29, 3, 'VIP', '+79274567890', 'МГИМО'),
(30, 3, 'Standard', '+79085678901', 'МГУ'),
(31, 3, 'Standard', '+79196789012', 'МФТИ'),
(32, 3, 'VIP', '+79207890123', 'НИУ ВШЭ'),
(33, 3, 'Standard', '+79018901234', 'МГИМО'),
(34, 3, 'Standard', '+79129012345', 'МГУ'),
(35, 3, 'VIP', '+79230123456', 'МФТИ'),
(36, 3, 'Standard', '+79041234567', 'НИУ ВШЭ'),
(37, 3, 'Standard', '+79152345678', 'МГИМО'),
(38, 3, 'VIP', '+79263456789', 'МГУ'),
(39, 3, 'Standard', '+79074567890', 'МФТИ'),
(40, 3, 'Standard', '+79185678901', 'НИУ ВШЭ'),
(41, 3, 'VIP', '+79296789012', 'МГИМО'),
(42, 3, 'Standard', '+79007890123', 'МГУ'),
(43, 3, 'Standard', '+79118901234', 'МФТИ'),
(44, 3, 'VIP', '+79229012345', 'НИУ ВШЭ'),
(45, 3, 'Standard', '+79030123456', 'МГИМО'),
(46, 3, 'Standard', '+79141234567', 'МГУ'),
(47, 3, 'VIP', '+79252345678', 'МФТИ'),
(48, 3, 'Standard', '+79063456789', 'НИУ ВШЭ'),
(49, 3, 'Standard', '+79174567890', 'МГИМО'),
(50, 3, 'VIP', '+79285678901', 'МГУ');

INSERT INTO Enters (ID_Member, ID_Party, Status, Emergency_number, University) VALUES
(51, 4, 'VIP', '+79096789012', 'МФТИ'),
(52, 4, 'Standard', '+79107890123', 'НИУ ВШЭ'),
(53, 4, 'Standard', '+79218901234', 'МГИМО'),
(54, 4, 'VIP', '+79029012345', 'МГУ'),
(55, 4, 'Standard', '+79130123456', 'МФТИ'),
(56, 4, 'Standard', '+79241234567', 'НИУ ВШЭ'),
(57, 4, 'VIP', '+79052345678', 'МГИМО'),
(58, 4, 'Standard', '+79163456789', 'МГУ'),
(59, 4, 'Standard', '+79274567890', 'МФТИ'),
(60, 4, 'VIP', '+79085678901', 'НИУ ВШЭ'),
(61, 4, 'Standard', '+79196789012', 'МГИМО'),
(62, 4, 'Standard', '+79207890123', 'МГУ'),
(63, 4, 'VIP', '+79018901234', 'МФТИ'),
(64, 4, 'Standard', '+79129012345', 'НИУ ВШЭ'),
(65, 4, 'Standard', '+79230123456', 'МГИМО'),
(66, 4, 'VIP', '+79041234567', 'МГУ'),
(67, 4, 'Standard', '+79152345678', 'МФТИ'),
(68, 4, 'Standard', '+79263456789', 'НИУ ВШЭ'),
(69, 4, 'VIP', '+79074567890', 'МГИМО'),
(70, 4, 'Standard', '+79185678901', 'МГУ'),
(71, 4, 'Standard', '+79296789012', 'МФТИ'),
(72, 4, 'VIP', '+79007890123', 'НИУ ВШЭ'),
(73, 4, 'Standard', '+79118901234', 'МГИМО'),
(74, 4, 'Standard', '+79229012345', 'МГУ'),
(75, 4, 'VIP', '+79030123456', 'МФТИ'),
(76, 4, 'Standard', '+79141234567', 'НИУ ВШЭ'),
(77, 4, 'Standard', '+79252345678', 'МГИМО'),
(78, 4, 'VIP', '+79063456789', 'МГУ'),
(79, 4, 'Standard', '+79174567890', 'МФТИ'),
(80, 4, 'Standard', '+79285678901', 'НИУ ВШЭ'),
(81, 4, 'VIP', '+79096789012', 'МГИМО'),
(82, 4, 'Standard', '+79107890123', 'МГУ'),
(83, 4, 'Standard', '+79218901234', 'МФТИ'),
(84, 4, 'VIP', '+79029012345', 'НИУ ВШЭ'),
(85, 4, 'Standard', '+79130123456', 'МГИМО'),
(86, 4, 'Standard', '+79241234567', 'МГУ'),
(87, 4, 'VIP', '+79052345678', 'МФТИ'),
(88, 4, 'Standard', '+79163456789', 'НИУ ВШЭ'),
(89, 4, 'Standard', '+79274567890', 'МГИМО'),
(90, 4, 'VIP', '+79085678901', 'МГУ');
INSERT INTO Enters (ID_Member, ID_Party, Status, Emergency_number, University) VALUES
(91, 5, 'VIP', '+79196789012', 'МФТИ'),
(92, 5, 'Standard', '+79207890123', 'НИУ ВШЭ'),
(93, 5, 'Standard', '+79018901234', 'МГИМО'),
(94, 5, 'VIP', '+79129012345', 'МГУ'),
(95, 5, 'Standard', '+79230123456', 'МФТИ'),
(96, 5, 'Standard', '+79041234567', 'НИУ ВШЭ'),
(97, 5, 'VIP', '+79152345678', 'МГИМО'),
(98, 5, 'Standard', '+79263456789', 'МГУ'),
(99, 5, 'Standard', '+79074567890', 'МФТИ'),
(100, 5, 'VIP', '+79185678901', 'НИУ ВШЭ'),
(1, 5, 'Standard', '+79296789012', 'МГИМО'),
(2, 5, 'Standard', '+79007890123', 'МГУ'),
(3, 5, 'VIP', '+79118901234', 'МФТИ'),
(4, 5, 'Standard', '+79229012345', 'НИУ ВШЭ'),
(5, 5, 'Standard', '+79030123456', 'МГИМО'),
(6, 5, 'VIP', '+79141234567', 'МГУ'),
(7, 5, 'Standard', '+79252345678', 'МФТИ'),
(8, 5, 'Standard', '+79063456789', 'НИУ ВШЭ'),
(9, 5, 'VIP', '+79174567890', 'МГИМО'),
(10, 5, 'Standard', '+79285678901', 'МГУ'),
(11, 5, 'Standard', '+79096789012', 'МФТИ'),
(12, 5, 'VIP', '+79107890123', 'НИУ ВШЭ'),
(13, 5, 'Standard', '+79218901234', 'МГИМО'),
(14, 5, 'Standard', '+79029012345', 'МГУ'),
(15, 5, 'VIP', '+79130123456', 'МФТИ'),
(16, 5, 'Standard', '+79241234567', 'НИУ ВШЭ'),
(17, 5, 'Standard', '+79052345678', 'МГИМО'),
(18, 5, 'VIP', '+79163456789', 'МГУ'),
(19, 5, 'Standard', '+79274567890', 'МФТИ'),
(20, 5, 'Standard', '+79085678901', 'НИУ ВШЭ'),
(21, 5, 'VIP', '+79196789012', 'МГИМО'),
(22, 5, 'Standard', '+79207890123', 'МГУ'),
(23, 5, 'Standard', '+79018901234', 'МФТИ'),
(24, 5, 'VIP', '+79129012345', 'НИУ ВШЭ'),
(25, 5, 'Standard', '+79230123456', 'МГИМО'),
(26, 5, 'Standard', '+79041234567', 'МГУ'),
(27, 5, 'VIP', '+79152345678', 'МФТИ'),
(28, 5, 'Standard', '+79263456789', 'НИУ ВШЭ'),
(29, 5, 'Standard', '+79074567890', 'МГИМО'),
(30, 5, 'VIP', '+79185678901', 'МГУ');

INSERT INTO Consumptions (ID_Party, Category, Price_per_unit, Number_of_units, Details) VALUES
(1, 'бытовые', -25000.00, 6, 'Аренда клуба "Гараж" (1 час)'),

(1, 'бар', -1500.00, 10, 'Водка "Белуга" (0.5л бутылка)'), -- 5 литров
(1, 'бар', -1800.00, 6, 'Виски Jack Daniels (0.5л бутылка)'), -- 3 литра
(1, 'бар', -1200.00, 8, 'Ром Bacardi (0.5л бутылка)'), -- 4 литра
(1, 'бар', -900.00, 10, 'Джин Beefeater (0.5л бутылка)'), -- 5 литров
(1, 'бар', -800.00, 6, 'Текила Olmeca (0.5л бутылка)'), -- 3 литра

(1, 'бар', 500.00, 30, 'Мохито (1 коктейль)'),
(1, 'бар', 550.00, 25, 'Маргарита (1 коктейль)'),
(1, 'бар', 450.00, 35, 'Лонг Айленд (1 коктейль)'),
(1, 'бар', 400.00, 40, 'Космополитен (1 коктейль)'),

(1, 'бытовые', -5000.00, 1, 'Уборка после мероприятия'),
(1, 'бытовые', -3000.00, 1, 'Охрана'),
(1, 'бытовые', -2000.00, 1, 'Аренда звукового оборудования'),

(1, 'билеты', 2000.00, 20, 'VIP билет'),
(1, 'билеты', 1000.00, 25, 'Standard билет'),

(1, 'бар', -150.00, 50, 'Вода (1 бутылка 0.5л)'),
(1, 'бар', -200.00, 40, 'Сок (1 упаковка 1л)'),
(1, 'бар', -100.00, 30, 'Лимонад (1 бутылка 0.5л)'),

(1, 'бар', 300.00, 60, 'Безалкогольный коктейль (1 шт)'),
(1, 'бар', 250.00, 50, 'Кофе (1 чашка)'),
(1, 'бар', 200.00, 40, 'Чай (1 чашка)');


INSERT INTO Consumptions (ID_Party, Category, Price_per_unit, Number_of_units, Details) VALUES
(2, 'бытовые', -30000.00, 6, 'Аренда лофта "Красный Октябрь" (1 час)'),
(2, 'бар', -1600.00, 8, 'Водка "Белуга" (0.5л бутылка)'), -- 4 литра
(2, 'бар', -1900.00, 6, 'Виски Jack Daniels (0.5л бутылка)'), -- 3 литра
(2, 'бар', -1300.00, 10, 'Ром Bacardi (0.5л бутылка)'), -- 5 литров
(2, 'бар', -950.00, 8, 'Джин Beefeater (0.5л бутылка)'), -- 4 литра
(2, 'бар', -850.00, 6, 'Текила Olmeca (0.5л бутылка)'), -- 3 литра
(2, 'бар', 520.00, 30, 'Мохито (1 коктейль)'),
(2, 'бар', 570.00, 25, 'Маргарита (1 коктейль)'),
(2, 'бар', 470.00, 35, 'Лонг Айленд (1 коктейль)'),
(2, 'бар', 420.00, 40, 'Космополитен (1 коктейль)'),
(2, 'бытовые', -5500.00, 1, 'Уборка после мероприятия'),
(2, 'бытовые', -3500.00, 1, 'Охрана'),
(2, 'бытовые', -2500.00, 1, 'Аренда звукового оборудования'),
(2, 'билеты', 2200.00, 18, 'VIP билет'),
(2, 'билеты', 1200.00, 24, 'Standard билет'),
(2, 'бар', -160.00, 50, 'Вода (1 бутылка 0.5л)'),
(2, 'бар', -210.00, 40, 'Сок (1 упаковка 1л)'),
(2, 'бар', -110.00, 30, 'Лимонад (1 бутылка 0.5л)'),
(2, 'бар', 310.00, 60, 'Безалкогольный коктейль (1 шт)'),
(2, 'бар', 260.00, 50, 'Кофе (1 чашка)'),
(2, 'бар', 210.00, 40, 'Чай (1 чашка)');

INSERT INTO Consumptions (ID_Party, Category, Price_per_unit, Number_of_units, Details) VALUES
(3, 'бытовые', -28000.00, 6, 'Аренда клуба "Икона" (1 час)'),
(3, 'бар', -1550.00, 10, 'Водка "Белуга" (0.5л бутылка)'), -- 5 литров
(3, 'бар', -1850.00, 6, 'Виски Jack Daniels (0.5л бутылка)'), -- 3 литра
(3, 'бар', -1250.00, 8, 'Ром Bacardi (0.5л бутылка)'), -- 4 литра
(3, 'бар', -925.00, 10, 'Джин Beefeater (0.5л бутылка)'), -- 5 литров
(3, 'бар', -825.00, 6, 'Текила Olmeca (0.5л бутылка)'), -- 3 литра
(3, 'бар', 510.00, 30, 'Мохито (1 коктейль)'),
(3, 'бар', 560.00, 25, 'Маргарита (1 коктейль)'),
(3, 'бар', 460.00, 35, 'Лонг Айленд (1 коктейль)'),
(3, 'бар', 410.00, 40, 'Космополитен (1 коктейль)'),
(3, 'бытовые', -5200.00, 1, 'Уборка после мероприятия'),
(3, 'бытовые', -3200.00, 1, 'Охрана'),
(3, 'бытовые', -2200.00, 1, 'Аренда звукового оборудования'),
(3, 'билеты', 2100.00, 20, 'VIP билет'),
(3, 'билеты', 1100.00, 25, 'Standard билет'),
(3, 'бар', -155.00, 50, 'Вода (1 бутылка 0.5л)'),
(3, 'бар', -205.00, 40, 'Сок (1 упаковка 1л)'),
(3, 'бар', -105.00, 30, 'Лимонад (1 бутылка 0.5л)'),
(3, 'бар', 305.00, 60, 'Безалкогольный коктейль (1 шт)'),
(3, 'бар', 255.00, 50, 'Кофе (1 чашка)'),
(3, 'бар', 205.00, 40, 'Чай (1 чашка)');

INSERT INTO Consumptions (ID_Party, Category, Price_per_unit, Number_of_units, Details) VALUES
(4, 'бытовые', -32000.00, 6, 'Аренда лофта "Флакон" (1 час)'),
(4, 'бар', -1650.00, 8, 'Водка "Белуга" (0.5л бутылка)'), -- 4 литра
(4, 'бар', -1950.00, 6, 'Виски Jack Daniels (0.5л бутылка)'), -- 3 литра
(4, 'бар', -1350.00, 10, 'Ром Bacardi (0.5л бутылка)'), -- 5 литров
(4, 'бар', -975.00, 8, 'Джин Beefeater (0.5л бутылка)'), -- 4 литра
(4, 'бар', -875.00, 6, 'Текила Olmeca (0.5л бутылка)'), -- 3 литра
(4, 'бар', 530.00, 30, 'Мохито (1 коктейль)'),
(4, 'бар', 580.00, 25, 'Маргарита (1 коктейль)'),
(4, 'бар', 480.00, 35, 'Лонг Айленд (1 коктейль)'),
(4, 'бар', 430.00, 40, 'Космополитен (1 коктейль)'),
(4, 'бытовые', -5700.00, 1, 'Уборка после мероприятия'),
(4, 'бытовые', -3700.00, 1, 'Охрана'),
(4, 'бытовые', -2700.00, 1, 'Аренда звукового оборудования'),
(4, 'билеты', 2300.00, 18, 'VIP билет'),
(4, 'билеты', 1300.00, 24, 'Standard билет'),
(4, 'бар', -165.00, 50, 'Вода (1 бутылка 0.5л)'),
(4, 'бар', -215.00, 40, 'Сок (1 упаковка 1л)'),
(4, 'бар', -115.00, 30, 'Лимонад (1 бутылка 0.5л)'),
(4, 'бар', 315.00, 60, 'Безалкогольный коктейль (1 шт)'),
(4, 'бар', 265.00, 50, 'Кофе (1 чашка)'),
(4, 'бар', 215.00, 40, 'Чай (1 чашка)');

INSERT INTO Consumptions (ID_Party, Category, Price_per_unit, Number_of_units, Details) VALUES
(5, 'бытовые', -27000.00, 6, 'Аренда клуба "Гараж" (1 час)'),
(5, 'бар', -1700.00, 10, 'Водка "Белуга" (0.5л бутылка)'), -- 5 литров
(5, 'бар', -2000.00, 6, 'Виски Jack Daniels (0.5л бутылка)'), -- 3 литра
(5, 'бар', -1400.00, 8, 'Ром Bacardi (0.5л бутылка)'), -- 4 литра
(5, 'бар', -1000.00, 10, 'Джин Beefeater (0.5л бутылка)'), -- 5 литров
(5, 'бар', -900.00, 6, 'Текила Olmeca (0.5л бутылка)'), -- 3 литра
(5, 'бар', 540.00, 30, 'Мохито (1 коктейль)'),
(5, 'бар', 590.00, 25, 'Маргарита (1 коктейль)'),
(5, 'бар', 490.00, 35, 'Лонг Айленд (1 коктейль)'),
(5, 'бар', 440.00, 40, 'Космополитен (1 коктейль)'),
(5, 'бытовые', -5400.00, 1, 'Уборка после мероприятия'),
(5, 'бытовые', -3400.00, 1, 'Охрана'),
(5, 'бытовые', -2400.00, 1, 'Аренда звукового оборудования'),
(5, 'билеты', 2400.00, 20, 'VIP билет'),
(5, 'билеты', 1400.00, 25, 'Standard билет'),
(5, 'бар', -170.00, 50, 'Вода (1 бутылка 0.5л)'),
(5, 'бар', -220.00, 40, 'Сок (1 упаковка 1л)'),
(5, 'бар', -120.00, 30, 'Лимонад (1 бутылка 0.5л)'),
(5, 'бар', 320.00, 60, 'Безалкогольный коктейль (1 шт)'),
(5, 'бар', 270.00, 50, 'Кофе (1 чашка)'),
(5, 'бар', 220.00, 40, 'Чай (1 чашка)');

INSERT INTO Sponsors (Email, Name) VALUES
('surfcoffee@mail.ru', 'Surf Coffee'),
('skuratov@mail.ru', 'Skuratov'),
('japan@mail.ru', 'Japan'),
('so_far_kebab@mail.ru', 'So Far Kebab'),
('frank_by_basta@mail.ru', 'Frank by Basta'),
('unilatex@mail.ru', 'Unilatex'),
('yandex@mail.ru', 'Yandex'),
('sberbank@mail.ru', 'Sberbank'),
('alpha_bank@mail.ru', 'Alpha Bank'),
('chiho@mail.ru', 'Chiho'),
('noodles@mail.ru', 'Noodles'),
('blackstar@mail.ru', 'Black Star'),
('kfc@mail.ru', 'KFC'),
('mcdonalds@mail.ru', 'McDonalds'),
('starbucks@mail.ru', 'Starbucks');

INSERT INTO Members (Name, Birthday, Number) VALUES
('Иванов Александр Сергеевич', '2000-05-15', '+79161234567'),
('Петрова Мария Дмитриевна', '2001-07-22', '+79262345678'),
('Сидоров Дмитрий Игоревич', '2002-03-10', '+79033456789'),
('Кузнецова Анна Владимировна', '2000-11-30', '+79174567890'),
('Смирнов Алексей Петрович', '2001-09-18', '+79285678901'),
('Федорова Екатерина Андреевна', '2002-12-05', '+79096789012'),
('Попов Иван Николаевич', '2003-04-25', '+79107890123'),
('Лебедева Ольга Сергеевна', '2000-08-12', '+79218901234'),
('Козлов Артем Викторович', '2001-06-08', '+79029012345'),
('Новикова Татьяна Михайловна', '2002-02-14', '+79130123456'),
('Морозов Денис Олегович', '2003-10-31', '+79241234567'),
('Волкова Юлия Александровна', '2000-01-20', '+79052345678'),
('Алексеев Павел Денисович', '2001-07-07', '+79163456789'),
('Егорова Надежда Викторовна', '2002-05-22', '+79274567890'),
('Соколов Максим Алексеевич', '2003-09-15', '+79085678901'),
('Белова Анастасия Игоревна', '2000-12-03', '+79196789012'),
('Григорьев Сергей Вадимович', '2001-04-17', '+79207890123'),
('Дмитриева Виктория Сергеевна', '2002-08-09', '+79018901234'),
('Фролов Андрей Константинович', '2003-03-28', '+79129012345'),
('Ковалева Елена Дмитриевна', '2000-11-11', '+79230123456'),
('Орлов Никита Артемович', '2001-02-25', '+79041234567'),
('Антонова Алина Павловна', '2002-06-19', '+79152345678'),
('Тарасов Владислав Ильич', '2003-10-08', '+79263456789'),
('Жукова Дарья Андреевна', '2000-04-30', '+79074567890'),
('Николаев Артур Эдуардович', '2001-09-12', '+79185678901'),
('Семенова Кристина Романовна', '2002-01-24', '+79296789012'),
('Борисов Роман Олегович', '2003-07-05', '+79007890123'),
('Михайлова Валерия Денисовна', '2000-03-18', '+79118901234'),
('Кириллов Илья Сергеевич', '2001-08-22', '+79229012345'),
('Герасимова Арина Максимовна', '2002-12-15', '+79030123456'),
('Данилов Артем Игоревич', '2003-05-28', '+79141234567'),
('Савельева Вероника Андреевна', '2000-10-10', '+79252345678'),
('Гусев Дмитрий Александрович', '2001-04-03', '+79063456789'),
('Тихонова Анастасия Витальевна', '2002-09-26', '+79174567890'),
('Максимов Кирилл Дмитриевич', '2003-02-14', '+79285678901'),
('Фомина Елизавета Сергеевна', '2000-07-07', '+79096789012'),
('Ильин Арсений Павлович', '2001-11-30', '+79107890123'),
('Романова София Игоревна', '2002-03-22', '+79218901234'),
('Соловьев Владимир Андреевич', '2003-08-15', '+79029012345'),
('Горбунова Марина Денисовна', '2000-01-28', '+79130123456'),
('Калинин Антон Викторович', '2001-06-12', '+79241234567'),
('Медведева Алиса Олеговна', '2002-10-05', '+79052345678'),
('Шестаков Евгений Сергеевич', '2003-04-18', '+79163456789'),
('Беляева Полина Андреевна', '2000-09-21', '+79274567890'),
('Зайцев Игорь Дмитриевич', '2001-02-14', '+79085678901'),
('Комарова Виктория Игоревна', '2002-07-27', '+79196789012'),
('Лазарев Артур Сергеевич', '2003-12-10', '+79207890123'),
('Суханова Ксения Витальевна', '2000-05-23', '+79018901234'),
('Тимофеев Денис Олегович', '2001-10-16', '+79129012345'),
('Крылова Анастасия Дмитриевна', '2002-04-09', '+79230123456'),
('Филиппов Алексей Андреевич', '2003-09-02', '+79041234567'),
('Мельникова Екатерина Сергеевна', '2000-02-15', '+79152345678'),
('Щербаков Никита Игоревич', '2001-07-28', '+79263456789'),
('Голубева Дарья Павловна', '2002-11-21', '+79074567890'),
('Кудрявцев Артем Витальевич', '2003-06-14', '+79185678901'),
('Сорокина Анна Александровна', '2000-01-07', '+79296789012'),
('Марков Дмитрий Олегович', '2001-05-20', '+79007890123'),
('Логинова Валерия Сергеевна', '2002-10-13', '+79118901234'),
('Быков Максим Денисович', '2003-03-06', '+79229012345'),
('Кузьмина Юлия Андреевна', '2000-08-19', '+79030123456'),
('Степанов Иван Игоревич', '2001-12-12', '+79141234567'),
('Власова Арина Викторовна', '2002-05-25', '+79252345678'),
('Королев Павел Сергеевич', '2003-10-18', '+79063456789'),
('Андреева Елена Дмитриевна', '2000-04-01', '+79174567890'),
('Гаврилов Артур Олегович', '2001-09-14', '+79285678901'),
('Давыдова Ксения Игоревна', '2002-02-27', '+79096789012'),
('Егоров Никита Андреевич', '2003-07-10', '+79107890123'),
('Зимина Анастасия Сергеевна', '2000-11-03', '+79218901234'),
('Исаев Денис Витальевич', '2001-04-16', '+79029012345'),
('Куликова Мария Дмитриевна', '2002-09-29', '+79130123456'),
('Мясников Алексей Игоревич', '2003-02-12', '+79241234567'),
('Осипова Виктория Андреевна', '2000-07-25', '+79052345678'),
('Павлов Артем Сергеевич', '2001-12-18', '+79163456789'),
('Родионова Дарья Олеговна', '2002-06-01', '+79274567890'),
('Симонов Игорь Денисович', '2003-10-24', '+79085678901'),
('Терентьева Алина Викторовна', '2000-03-17', '+79196789012'),
('Устинов Дмитрий Игоревич', '2001-08-30', '+79207890123'),
('Федотова Екатерина Сергеевна', '2002-01-23', '+79018901234'),
('Харитонов Артур Андреевич', '2003-06-16', '+79129012345'),
('Цветкова Анна Дмитриевна', '2000-11-09', '+79230123456'),
('Чернов Максим Витальевич', '2001-04-22', '+79041234567'),
('Шарова Ольга Игоревна', '2002-09-15', '+79152345678'),
('Яковлев Денис Сергеевич', '2003-02-28', '+79263456789'),
('Абрамова Виктория Андреевна', '2000-07-11', '+79074567890'),
('Баранов Павел Дмитриевич', '2001-12-04', '+79185678901'),
('Воронова Анастасия Игоревна', '2002-05-27', '+79296789012'),
('Гришин Артем Сергеевич', '2003-10-20', '+79007890123'),
('Дорофеева Елизавета Олеговна', '2000-03-13', '+79118901234'),
('Жуков Илья Витальевич', '2001-08-26', '+79229012345'),
('Зайцева Марина Дмитриевна', '2002-01-19', '+79030123456'),
('Игнатьев Сергей Андреевич', '2003-06-12', '+79141234567'),
('Казакова Анна Игоревна', '2000-11-05', '+79252345678'),
('Ларин Дмитрий Сергеевич', '2001-04-18', '+79063456789'),
('Макеева Кристина Витальевна', '2002-09-01', '+79174567890'),
('Назаров Артур Дмитриевич', '2003-02-14', '+79285678901'),
('Овчинникова Виктория Андреевна', '2000-07-27', '+79096789012'),
('Поляков Иван Игоревич', '2001-12-20', '+79107890123'),
('Рябова Дарья Сергеевна', '2002-06-13', '+79218901234'),
('Савин Алексей Витальевич', '2003-10-06', '+79029012345'),
('Тихомирова Елена Дмитриевна', '2000-03-29', '+79130123456'),
('Уваров Никита Андреевич', '2001-08-12', '+79241234567'),
('Фролова Анастасия Игоревна', '2002-01-05', '+79052345678'),
('Хохлов Артем Сергеевич', '2003-06-28', '+79163456789'),
('Царева Мария Витальевна', '2000-11-21', '+79274567890'),
('Черепанов Денис Дмитриевич', '2001-04-14', '+79085678901'),
('Широкова Ольга Андреевна', '2002-09-07', '+79196789012'),
('Щукин Игорь Игоревич', '2003-02-20', '+79207890123'),
('Яковлева Анна Сергеевна', '2000-07-13', '+79018901234');

SELECT m.Name, m.Number, e.University  -- Список VIP-участников "Др ФПМИ" с сортировкой по имени
FROM Members m
JOIN Enters e ON m.ID_Member = e.ID_Member
JOIN Parties p ON e.ID_Party = p.ID_Party
WHERE p.Name = 'День рождения ФПМИ' AND e.Status = 'VIP'
ORDER BY m.Name;

-- Мероприятия с количеством участников более 45
SELECT p.Name, COUNT(e.ID_Member) as ParticipantsCount
FROM Parties p
JOIN Enters e ON p.ID_Party = e.ID_Party
GROUP BY p.Name
HAVING COUNT(e.ID_Member) > 45
ORDER BY ParticipantsCount DESC;

-- Список организаторов с их ролями на каждом мероприятии

SELECT p.Name as EventName, o.Name as OrganizerName, o.Role
FROM Parties p
JOIN Organizers o ON p.ID_Party = o.ID_Party
ORDER BY p.Name, o.Role;

-- Участники которые посещали мероприятия с финансовой поддержкой от Yandex
SELECT DISTINCT m.Name, m.Number
FROM Members m
JOIN Enters e ON m.ID_Member = e.ID_Member
WHERE e.ID_Party IN (
    SELECT s.ID_Party
    FROM Sponsorship s
    JOIN Sponsors sp ON s.ID_Sponsor = sp.ID_Sponsor
    WHERE sp.Name = 'Yandex' AND s.Category = 'продукция'
);

-- Рейтинг мероприятий по доходам от билетов
SELECT 
    p.Name,
    SUM(c.Price_per_unit * c.Number_of_units) as TicketRevenue,
    RANK() OVER (ORDER BY SUM(c.Price_per_unit * c.Number_of_units) DESC) as RevenueRank
FROM Parties p
JOIN Consumptions c ON p.ID_Party = c.ID_Party
WHERE c.Category = 'билеты'
GROUP BY p.Name;

-- Спонсоры, которые поддерживали мероприятия в 2021 году
SELECT s.Name, s.Email
FROM Sponsors s
WHERE EXISTS (
    SELECT 1
    FROM Sponsorship sp
    JOIN Parties p ON sp.ID_Party = p.ID_Party
    WHERE sp.ID_Sponsor = s.ID_Sponsor 
    AND EXTRACT(YEAR FROM p.Date) = 2021
);

-- Доля расходов на алкоголь в общих расходах по мероприятиям

SELECT 
    p.Name,
    SUM(CASE WHEN c.Category = 'бар' AND c.Price_per_unit < 0 
        THEN ABS(c.Price_per_unit * c.Number_of_units) ELSE 0 END) as AlcoholCost,
    SUM(ABS(c.Price_per_unit * c.Number_of_units)) as TotalExpenses,
    ROUND(SUM(CASE WHEN c.Category = 'бар' AND c.Price_per_unit < 0 
        THEN ABS(c.Price_per_unit * c.Number_of_units) ELSE 0 END) * 100.0 / 
        SUM(ABS(c.Price_per_unit * c.Number_of_units)), 2) as AlcoholPercentage
FROM Parties p
JOIN Consumptions c ON p.ID_Party = c.ID_Party
WHERE c.Price_per_unit < 0
GROUP BY p.Name
ORDER BY AlcoholPercentage DESC;

-- Участники, которые меняли номера телефонов более одного раза
SELECT m.Name, COUNT(h.ID_Change) as NumberChanges
FROM Members m
JOIN Members_history h ON m.ID_Member = h.ID_Member
GROUP BY m.Name
HAVING COUNT(h.ID_Change) > 0
ORDER BY NumberChanges DESC;

-- Топ-5 самых прибыльных мероприятий с информацией о спонсорах
SELECT 
    p.Name as EventName,
    p.Date,
    SUM(CASE WHEN c.Price_per_unit > 0 THEN c.Price_per_unit * c.Number_of_units ELSE 0 END) - 
    SUM(CASE WHEN c.Price_per_unit < 0 THEN ABS(c.Price_per_unit * c.Number_of_units) ELSE 0 END) as Profit,
    STRING_AGG(DISTINCT s.Name, ', ') as Sponsors
FROM Parties p
LEFT JOIN Consumptions c ON p.ID_Party = c.ID_Party
LEFT JOIN Sponsorship sp ON p.ID_Party = sp.ID_Party
LEFT JOIN Sponsors s ON sp.ID_Sponsor = s.ID_Sponsor
GROUP BY p.Name, p.Date
ORDER BY Profit DESC
LIMIT 5 OFFSET 0;